{%- macro renderSlider(product_list, prefix, cols, url) -%}
{%- set languages = { 'ES': 'Espa&ntilde;ol', 'EN': 'Ingl&eacute;s' } -%}
<div class="viewport">
    <ul class="overview">
{%- if product_list is iterable -%}
    {%- for p in product_list -%}
        {%- set title  = p.Title.decode('utf-8')|e -%}
        {%- set section  = p.Categoria_Seccion|string -%}
        {%- set price  = p.PriceAmount|string -%}
        {%- set product_id  = p.ProductId|string -%}
        {%- set product_url  = p.LinkBase ~ '.htm' -%}
        {%- set hs = p.FulfillmentValue|int -%}
        {%- if p.Authors[0] -%}
            {%- set author = p.Authors[0].ContributorName.decode('utf-8')|e -%}
            {%- set author_id = p.Authors[0].ContributorId|string -%}
        {%- else -%}
            {%- set author = None -%}
            {%- set author_id = 0 -%}
        {%- endif -%}
        {%- if p.ImprintName != None -%}
            {%- set imprint = p.ImprintName.decode('utf-8')|e -%}
        {%- endif -%}
        {%- if p.ProductForm[0] == 'B' -%}
            {%- set book = True -%}
        {%- elif p.ProductForm[0] == 'A' -%}
            {%- set music = True -%}
        {%- elif p.ProductForm[0] == 'V' -%}
            {%- set movie = True -%}
        {%- elif p.ProductForm[0] == 'Z' -%}
            {%- set generic = True -%}
        {%- endif -%}
        {%- if (loop.index % cols) == 1 -%}
            <li> {#- start row -#}
            <table>
                <tr>
        {%- else -%}
                <td>&nbsp;</td>
        {%- endif -%}
                <td class="product-entry">
                    <a href="{{ product_url }}" title="{{ title }}">
                        <img src="{{ url.images ~ p.CoverSmall|e }}" width="98" alt="{{ title }}">
                    </a>

                    {#- POP UP CONTENT HOLDER -#}
                    <div class="product-popup-content">
                        {#- TITLE -#}
                        <table><tbody><tr><td class="product-popup-titleauthor">
                        <p class="product-popup-title">
                            <a href="{{ product_url }}">{{ title }}</a>
                        </p>
                        {#- AUTHOR -#}
                        {%- if author -%}
                            <p class="product-author">de <a href="/buscador/productos.jsp?seccion={{ section }}&amp;idSeccion={{ section }}&amp;criterioDeOrden=2&amp;claveDeBusqueda=porIDdeAutor&amp;texto={{ author|e }}&amp;idAutor={{ author_id }}">{{ author }}</a></p>
                        {%- endif -%}
                        </td><td>
                        <p class="product-popup-price">$ {{ price -}}</p>
                        </td></tr></tbody></table>
                        {#- BUY -#}
                        <p class="product-cart-add">
                        {%- if p.ProductAvailability == '21' -%}
                            <a href="javascript:APP.cartAdd({{ product_id }})" title="agregar al carrito"><img src="{{ url.images }}/imagenes/rediseno/imagenes/seccionTematika/b-comprar.png" alt="agregar al carrito"></a>
                        {%- else -%} {#- ProductAvailability == '22' -#}
                            <a href="javascript:if (confirm('Este producto no esta disponible actualmente. Desea hacer un pedido?'))document.location = '/PedidoEspecial?ID_ARTICULO={{ product_id }}';"><img src="{{ url.images}}/imagenes/rediseno/imagenes/seccionTematika/b-pedir.png" alt="Pedir"></a>
                        {%- endif -%}
                        </p>
                        {%- if p.ImprintName != None -%}
                            {%- if   book  -%}Editorial:
                            {%- elif music -%}Discogr&aacute;fica:
                            {%- elif movie -%}Productora:
                            {%- else       -%}Editorial:
                            {%- endif -%}
                            <span class="product-imprint">
                                <a href="/buscador/productos.jsp?seccion={{ section }}&amp;idSeccion={{ section }}&amp;criterioDeOrden=2&amp;claveDeBusqueda=porIDdeEditorial&amp;texto={{ imprint }}&amp;idEditor={{ p.ImprintId|string }}" id="artEditor">{{ imprint }}</a>
                            </span><br>
                        {%- endif -%}
                        {%- if p.Rating -%}
                            {%- set s = p.Rating|round|int -%}
                            Calificaci&oacute;n:
                            <span class="product-rating"
                                    title="{{ "%.2f"|format(p.Rating) }}">
                            {%- for i in range(s) -%}
                                <img src="{{ url.images }}/imagenes/rediseno/imagenes/comun/calificacionStar-back.png" alt="estrella">
                            {%- endfor -%}
                            {%- for i in range(5 - s) -%}
                                <img src="{{ url.images }}/imagenes/rediseno/imagenes/comun/calificacionStarDes-back.png" alt="estrella off">
                            {%- endfor -%}
                            </span>
                        {%- endif -%}
                        {%- if p.CommentCount > 0 -%}
                            <a href="{{ product_url }}.htm#coment">
                                {{ p.CommentCount|int }} comentario
                                {%- if p.CommentCount > 1 -%}s{%- endif -%}</a>
                        {%- endif -%}
                        {%- if p.Rating or p.CommentCount -%}
                            <br>
                        {%- endif -%}
                        {%- if p.Ranking -%}
                            Ranking: <span class="product-ranking">
                                {{- p.Ranking -}}
                            </span><br>
                        {%- endif -%}
                        {%- if p.PublishingDateValue -%}
                            {%- set pd = p.PublishingDateValue -%}
                            Fecha de publicaci&oacute;n:
                            <span class="product-date">
                                {{- (pd[6:8], pd[4:6], pd[0:4])|join('/') -}}
                            </span><br>
                        {%- endif -%}
                        {%- if p.LanguageCode -%}
                            Idioma:
                            <span class="product-language">
                                {{- languages[p.LanguageCode] -}}
                            </span><br>
                        {%- endif -%}
                        {%- if p.ExtentValue -%}
                            P&aacute;ginas:
                            <span class="product-pages">
                                {{- p.ExtentValue -}}
                            </span><br>
                        {%- endif -%}
                        {%- if p.ProductForm_desc != None -%}
                            {%- if book -%}
                                Edici&oacute;n:
                            {%- else -%}
                                Formato:
                            {%- endif -%}
                            <span class="product-format">
                                {{- p.ProductForm_desc.decode('utf-8') -}}
                            </span><br>
                        {%- endif -%}
                        <table class="product-infocomment"><tbody><tr>
                            <td class="product-moreinfo">
                            <a href="{{ product_url }}">+ info</a></td>
                            <td class="product-comment">
                            <a href="/Comentario?ID_ARTICULO={{ product_id }}">
                                agregar comentario</a></td>
                        </tr></tbody></table>
                        Entrega:
                        <span class="product-fulfillment">
                            Salida del dep&oacute;sito en
                            {{ hs }} horas h&aacute;biles
                        </span><br>
                        <span class="product-delivery-note">
                                + <a href="javascript:false;">
                            Tiempo de Env&iacute;o
                            <br><span>
                            Capital Federal: {{ hs }} horas
                            h&aacute;biles.<br>
                            GBA: {{ hs + 24 }} horas h&aacute;biles.<br>
                            Interior del pa&iacute;s: {{ hs + 48 }} horas
                            h&aacute;biles.<br>
                            Resto del Mundo: var&iacute;a entre
                            {{ hs + 24 }} a {{ hs + 48 }} horas
                            h&aacute;biles dependiendo si se trata de una
                            ciudad capital.<br>
                            El horario de entrega para los pedidos dentro
                            de Argentina es de Lunes a Viernes de 9 a 18hs.
                            </span></a>
                        </span><br>
                    </div> <!-- p-popup -->
                </td>
        {%- if loop.index is divisibleby cols -%}
                </tr>
            </table>
            </li> {#- end row -#}
        {%- endif %}
    {%- endfor %}
    {%- if not product_list|length is divisibleby cols -%}
        {#- fill remaining cols -#}
        {%- for c in range(cols - (product_list|length % cols)) -%}
                <td>&nbsp;</td>
                <td>&nbsp;</td>
        {%- endfor -%}
            </tr>
        </table>
        </li>
    {%- endif %}
{%- else -%} {#- product_list iterable -#}
    XXXXXXXXX section: {{ prefix }}
    XXXXXXXXX product_list: {{ product_list|pprint }}
{%- endif -%}
    <li><table><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></table></li>
    </ul>
</div>
{%- endmacro -%}
